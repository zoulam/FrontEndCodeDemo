# mpvue-koa
## åŸºæœ¬ä¿¡æ¯

[é…å¥—è§†é¢‘æ•™ç¨‹ï¼Œæœ¬äººä»…æ˜¯å­¦ä¹ ä½¿ç”¨](https://www.bilibili.com/video/av83423939/)

[åŸé¡¹ç›®åœ°å€](https://github.com/cleversnail/mpvue-koa)

**mpvue-shop æ–‡ä»¶æ˜¯è¯¥å°ç¨‹åºçš„å‰ç«¯é¡¹ç›®ï¼Œä½¿ç”¨mpvue**

**mpvue-shop-node æ–‡ä»¶æ˜¯è¯¥å°ç¨‹åºçš„åç«¯é¡¹ç›®ï¼Œä½¿ç”¨koa2**

2. åˆ†åˆ«åœ¨ `mpvue-shop` å’Œ `mpvue-shop-node` ä¸­æ‰§è¡Œ `npm install`

3. åœ¨ `mpvue-shop` é¡¹ç›®ä¸­æ‰§è¡Œ `npm run dev`ï¼ˆä¼šç”Ÿæˆä¸€ä¸ªdistç›®å½•ï¼‰, ç”¨å°ç¨‹åºå¼€å‘è€…å·¥å…·æ‰“å¼€è¿™ä¸ª `dist > wx` å³å¯çœ‹åˆ°æ•ˆæœ,æ­¤å¤„æ˜¯å°†mpvueé¡¹ç›®æ‰“åŒ…æˆå°ç¨‹åºèƒ½è¯†åˆ«çš„é¡¹ç›®ä»£ç ã€‚
**æ ¹æ®æœºå™¨æ€§èƒ½ç¼–è¯‘æ—¶é—´å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œè¯·è€å¿ƒç­‰å¾…**  æ§åˆ¶å°å‡ºç°`DONE  Compiled successfully`å­—æ ·å³æˆåŠŸå®Œæˆç¼–è¯‘ï¼Œè¿™æ˜¯ä¸€ä¸ªå®æ—¶ç¼–è¯‘çš„å‘½ä»¤ï¼Œå³ä½ çš„åˆšåˆšä¿®æ”¹çš„å†…å®¹ä¹Ÿä¼šè¢«ç¼–è¯‘å‡ºå»ï¼Œä½¿ç”¨`ctrl+c`å¯ä»¥ç»ˆæ­¢ï¼Œå‡å°‘èµ„æºå ç”¨ã€‚

4. åœ¨ `mpvue-shop-node` é¡¹ç›®ä¸­ æ›´æ”¹`config.js`ä¸­çš„`mysql` è´¦å·å¯†ç ï¼ˆ`user`å’Œ`pass`æ”¹ä¸ºè‡ªå·±çš„ï¼‰

5. å°† `mpvue-shop-node` ä¸­çš„ `nodemysql.sql` å¯¼å…¥åˆ°æœ¬åœ°`mysql`åº“ä¸­ï¼Œä¾ç…§ä¸ªäººä¹ æƒ¯æ“ä½œï¼Œä½ å¯ä»¥ä½¿ç”¨å›¾å½¢åŒ–ç•Œé¢å¯¼å…¥ï¼Œä¸‹é¢æ˜¯å‘½ä»¤è¡Œå¯¼å…¥ä»‹ç»ã€‚

    ```bash
    #åˆ é™¤æ•°æ®åº“(å¦‚æœä½ å‰é¢å¯¼å…¥åŒåæ•°æ®åº“æƒ³è¦ç»§ç»­å¯¼å…¥åˆ™éœ€è¦å…ˆåˆ é™¤)
    drop database nodemysql;

    #åˆ›å»ºæ•°æ®åº“nodenysql
    create database nodemysql;

    #æŸ¥çœ‹å·²æœ‰æ•°æ®åº“(è™½ç„¶ä¼šæç¤ºåˆ›å»ºæˆåŠŸï¼Œä½†è¿˜æ˜¯ç¡®è®¤ä¸€ä¸‹ğŸ˜‚)
    show databases;

    #è¿›å…¥æ•°æ®åº“nodemysql
    use nodemysql;

    #è®¾ç½®æ•°æ®åº“ç¼–ç ä¸ºutf8mb4(è®¾ç½®ä¸€ä¸‹ç¼–ç ï¼Œè‹¥æ˜¯è®¾ç½®å¤±è´¥è¯·å‡çº§mysqlç‰ˆæœ¬)
    set names utf8mb4;

    #å¯¼å…¥æ•°æ®åº“æ–‡ä»¶
    source æ•°æ®åº“æ–‡ä»¶è·¯å¾„;

    #æŸ¥çœ‹æ•°æ®åº“ä¸­çš„è¡¨å†…å®¹
    show tables;
    ```


5. åœ¨ `mpvue-shop-node` é¡¹ç›®ä¸­æ‰§è¡Œ `nodemon app.js` åˆ°æ­¤ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°å®Œæ•´çš„æ•ˆæœ

## ä¸€äº›å‘

### â‘ å®æ—¶ç¼–è¯‘nodeä»£ç çš„åŒ…ï¼Œéœ€è¦è‡ªè¡Œå®‰è£…æ‰æœ‰`nodemon`å‘½ä»¤ï¼Œç”¨`node`å‘½ä»¤ä¹Ÿæ˜¯ä¸€æ ·çš„æ•ˆæœ

### â‘¡éœ€è¦ä¿®æ”¹å°ç¨‹åºè®¾ç½®ï¼Œå¦åˆ™åç«¯æ•°æ®æ— æ³•åŠ è½½ã€‚

**ä¼šè¢«è®¤ä¸ºæ˜¯éæ³•æˆ–ä¸å®‰å…¨çš„åŸŸå**

![image-20200722115926517](https://zoulam-pic-repo.oss-cn-beijing.aliyuncs.com/img/image-20200722115926517.png)

### â‘¢å…³äºæ•°æ®åº“ç‰ˆæœ¬é—®é¢˜

æœ¬äººæ•°æ®åº“ç‰ˆæœ¬`5.7.29 MySQL Community Server (GPL)`

**http500é”™è¯¯**

mysqlæ˜¯é»˜è®¤å¯†ç éªŒè¯æ˜¯ä¸¥æ ¼æ¨¡å¼ã€å°†å®ƒè®¾ç½®ä¸ºæ™®é€šæ¨¡å¼å°±èƒ½è§£å†³é—®é¢˜

>å¤§æ„æ˜¯8.0.4å¼€å§‹mysqlå¼•å…¥ä¸€ä¸ªcaching_sha2_passwordæ¨¡å—ä½œä¸ºé»˜è®¤èº«ä»½éªŒè¯æ’ä»¶ï¼Œæ•°æ®åº“è¿æ¥æ—¶éªŒè¯èº«ä»½çš„å·¥ä½œæ–¹å¼(handshake process)ä¼šä¸ä»¥å¾€ä¸åŒã€‚
>
>ä½†ä»¥å‰ç‰ˆæœ¬çš„é€šè¿‡mysql_native_password åˆ›å»ºçš„è´¦æˆ·ä»ç„¶å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œåªæ˜¯éªŒè¯è¿™äº›è´¦æˆ·æ—¶ä¼šåˆ‡å›mysql_native_passwordçš„å·¥ä½œæ–¹å¼ï¼Œä»¥æ­¤å®ç°å‘ä¸‹å…¼å®¹ã€‚
>
>nodejsç‰ˆæœ¬å°šæœªè·Ÿè¿›caching_sha2_passwordçš„å®ç°ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡ä¸Šé¢å‘½ä»¤æ¥æ‰‹åŠ¨åˆ‡æ¢éªŒè¯è´¦å·æ–¹å¼ã€‚

`yourpassword `æ˜¯ä½ çš„æ•°æ®åº“è´¦æˆ·å¯†ç ï¼Œ`root`å’Œ`localhost`ä¹Ÿæ˜¯

```mysql
ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'yourpassword';
flush privileges;
```

alter user 'root'@'localhost' identified with mysql_native_password by '123456';

### â‘£å°ç¨‹åºè·å–ä½ç½®ä¿¡æ¯éœ€è¦å¼ºåˆ¶æç¤º

[å®˜æ–¹åœ°å€](https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html#permission)

**åªéœ€è¦åœ¨`mpvue-shop\src\app.json`é…ç½®ä¸­æ·»åŠ ä»¥ä¸‹ä¿¡æ¯**

```json
  "permission": {
    "scope.userLocation": {
      "desc": "ä½ çš„ä½ç½®ä¿¡æ¯å°†ç”¨ä½œæä¾›æ›´å¥½çš„åœ°å€æœåŠ¡"
    }
```

**æ·»åŠ ä¹‹ååˆ«å¿˜è®°é‡æ–°ç¼–è¯‘**

